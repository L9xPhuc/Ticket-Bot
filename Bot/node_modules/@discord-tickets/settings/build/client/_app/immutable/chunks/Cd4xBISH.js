var pe=Object.defineProperty;var ee=s=>{throw TypeError(s)};var _e=(s,e,t)=>e in s?pe(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var l=(s,e,t)=>_e(s,typeof e!="symbol"?e+"":e,t),ge=(s,e,t)=>e.has(s)||ee("Cannot "+t);var g=(s,e,t)=>(ge(s,e,"read from private field"),t?t.call(s):e.get(s)),w=(s,e,t)=>e.has(s)?ee("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t);import"./Bg9kRutz.js";import{l as Z,F as ke,O as xe,i as ye,aV as Ce,ad as te,a4 as J,a6 as se,v as re,j as K,C as be,m as Ee,aq as ae,ap as ne,aW as oe,H as Be,a0 as ie,G as Q,o as we,at as Oe,p as de,f as u,a as ue,aO as Ie,b as z,g as i,s as F,h as Me,d as Ne,n as ce}from"./D0Xv9YzD.js";import{c as _,a as h,t as Ae}from"./BCej-IkM.js";import{i as G}from"./C1nl-272.js";import{e as Pe}from"./BU36I_Bd.js";import{s as P}from"./BPwLybW9.js";import{c as le}from"./CdBMWnb0.js";import{a as T,s as fe}from"./y_msc5TT.js";const X=0,S=1,Y=2;function Te(s,e,t,r,n){Z&&ke();var o=s,y=xe(),f=Be,a=te,m,C,B,I=(y?se:re)(void 0),q=(y?se:re)(void 0),M=!1;function v(c,d){M=!0,d&&(ae(k),ne(k),oe(f));try{c===X&&t&&(m?ie(m):m=K(()=>t(o))),c===S&&r&&(C?ie(C):C=K(()=>r(o,I))),c!==X&&m&&Q(m,()=>m=null),c!==S&&C&&Q(C,()=>C=null),c!==Y&&B&&Q(B,()=>B=null)}finally{d&&(oe(null),ne(null),ae(null),we())}}var k=ye(()=>{if(a!==(a=e())){if(Ce(a)){var c=a;M=!1,c.then(d=>{c===a&&(J(I,d),v(S,!0))},d=>{if(c===a)throw J(q,d),v(Y,!0),q.v}),Z?t&&(m=K(()=>t(o))):be(()=>{M||v(X,!0)})}else J(I,a),v(S,!1);return()=>a=te}});Z&&(o=Ee)}const he=Symbol("modal");function De(s){Ie(he,s)}function He(){return Oe(he)}function Ke(s){try{const e=He();e.onBeforeClose=s}catch{console.error("onBeforeClose must be called inside a component rendered by Modals");return}}function Le(s,e){de(e,!0),De(e.modal);var t=_(),r=u(t);P(r,()=>e.children),h(s,t),ue()}var D,R;const U=class U extends EventTarget{constructor(t,{id:r,component:n,props:o}){super();l(this,"_props");l(this,"result",je());l(this,"id");l(this,"component");l(this,"modals");w(this,D,z(!1));w(this,R,Me(()=>this.modals.stack.length===0?!1:this.modals.stack[this.modals.stack.length-1].id===this.id&&!this.modals.transitioning));l(this,"close",(...t)=>{var n;if(((n=this.onBeforeClose)==null?void 0:n.call(this))===!1)return!1;const r=t[0];return this.dispatchEvent(new CustomEvent("close",{detail:r})),this.result.resolve(r),!0});l(this,"onBeforeClose");this.id=r||(U._idCounter++).toString(),this.component=n,this._props=o??{},this.modals=t}get exitBeforeEnter(){return i(g(this,D))}set exitBeforeEnter(t){F(g(this,D),T(t))}get isOpen(){return i(g(this,R))}get index(){return this.modals.stack.indexOf(this)}get props(){return{...this._props,id:this.id,index:this.index,isOpen:this.isOpen,close:this.close}}get promise(){return this.result.promise}};D=new WeakMap,R=new WeakMap,l(U,"_idCounter",0);let $=U;function je(){let s,e;return{promise:new Promise((r,n)=>{s=r,e=n}),resolve:s,reject:e}}var H,L,j;class qe{constructor(){w(this,H,z(T([])));w(this,L,z(null));w(this,j,z(!1));l(this,"open",async(e,t,r)=>{var y;if(this.transitioning)return;if(r!=null&&r.replace&&!((y=this.stack[this.stack.length-1])==null?void 0:y.close()))throw new Error("Current modal prevented closing");this.action="push";const n=this.stack[this.stack.length-1];n!=null&&n.exitBeforeEnter&&(this.transitioning=!0);const o=new $(this,{id:r==null?void 0:r.id,component:e,props:t});return this.stack.push(o),o.addEventListener("close",()=>{o.exitBeforeEnter&&(this.transitioning=!0),this.stack.indexOf(o)>-1&&this.stack.splice(this.stack.indexOf(o),1),this.action="pop"},{once:!0}),o.promise});l(this,"close",(e=1)=>{if(typeof e!="number"||e<1)throw new Error(`amount must be a number greater than 0. Received ${e}`);const t=this.stack.slice(this.stack.length-e).reverse();let r=0;for(const n of t){if(!n.close())break;r++}return e===r});l(this,"closeById",e=>{const t=this.stack.find(r=>r.id===e);return t?t.close():!1});l(this,"closeAll",()=>this.close(this.stack.length))}get stack(){return i(g(this,H))}set stack(e){F(g(this,H),T(e))}get action(){return i(g(this,L))}set action(e){F(g(this,L),T(e))}get transitioning(){return i(g(this,j))}set transitioning(e){F(g(this,j),T(e))}}H=new WeakMap,L=new WeakMap,j=new WeakMap;const O=new qe;var Ge=Ae("<!> <!>",1);function Qe(s,e){de(e,!0);function t(f){return typeof f.prototype>"u"}var r=Ge(),n=u(r);{var o=f=>{var a=_(),m=u(a);P(m,()=>e.backdrop??ce,()=>O),h(f,a)};G(n,f=>{O.stack.length>0&&f(o)})}var y=Ne(n,2);Pe(y,19,()=>O.stack,f=>f.id,(f,a)=>{Le(f,{get modal(){return i(a)},children:(m,C)=>{var B=_(),I=u(B);{var q=v=>{var k=_(),c=u(k);Te(c,()=>i(a).component(),d=>{var b=_(),p=u(b);P(p,()=>e.loading??ce,()=>O),h(d,b)},(d,b)=>{var p=_(),E=u(p);{var N=x=>{var A=_(),W=u(A);P(W,()=>e.modal,()=>({component:i(b).default,props:i(a).props}),()=>O),h(x,A)},V=x=>{var A=_(),W=u(A);le(W,()=>i(b).default,(me,ve)=>{ve(me,fe(()=>i(a).props))}),h(x,A)};G(E,x=>{e.modal?x(N):x(V,!1)})}h(d,p)}),h(v,k)},M=v=>{var k=_(),c=u(k);{var d=p=>{var E=_(),N=u(E);P(N,()=>e.modal,()=>({component:i(a).component,props:i(a).props}),()=>O),h(p,E)},b=p=>{var E=_(),N=u(E);le(N,()=>i(a).component,(V,x)=>{x(V,fe(()=>i(a).props))}),h(p,E)};G(c,p=>{e.modal?p(d):p(b,!1)})}h(v,k)};G(I,v=>{t(i(a).component)?v(q):v(M,!1)})}h(m,B)},$$slots:{default:!0}})}),h(s,r),ue()}export{Qe as M,O as m,Ke as o};
